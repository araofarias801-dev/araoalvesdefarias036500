CREATE TABLE usuario (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	username VARCHAR(100) NOT NULL,
	senha_hash VARCHAR(200) NOT NULL,
	roles VARCHAR(200) NOT NULL,
	criado_em TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE UNIQUE INDEX ux_usuario_username ON usuario (username);

CREATE TABLE refresh_token (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	usuario_id BIGINT NOT NULL,
	token VARCHAR(200) NOT NULL,
	expira_em TIMESTAMP NOT NULL,
	revogado BOOLEAN NOT NULL DEFAULT FALSE,
	criado_em TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	CONSTRAINT fk_refresh_token_usuario FOREIGN KEY (usuario_id) REFERENCES usuario (id)
);

CREATE UNIQUE INDEX ux_refresh_token_token ON refresh_token (token);
